import{r as L}from"./notification-VK8kKwQN.js";import"./firebase-init-DQxvl9Em.js";import"./index.esm2017-BPEvCmAA.js";document.addEventListener("DOMContentLoaded",()=>{window.lastLoadedMessageId=0;let r=null,i=null;const u=window.Laravel.user.id,d=document.querySelector('meta[name="csrf-token"]').getAttribute("content");function m(e,t){fetch(`/chats/${t}/${e}/mark-read`,{method:"POST",headers:{"X-CSRF-TOKEN":d}}).catch(n=>console.error("Ошибка при пометке сообщений как прочитанных:",n))}function h(e,t){r=e,i=t;const a=document.getElementById("chat-messages").querySelector("ul");a.innerHTML="",window.lastLoadedMessageId=0;const c=document.querySelector(`[data-chat-id="${e}"][data-chat-type="${t}"] h5`),o=document.getElementById("chat-header");o.textContent=c?c.textContent:"Выберите чат для общения",fetch(`/chats/${t}/${e}/messages`).then(s=>{if(!s.ok)throw new Error("Network response was not ok");return s.json()}).then(s=>{if(a.innerHTML="",s.messages&&s.messages.length>0){const g=s.messages[s.messages.length-1];window.lastLoadedMessageId=g.id}L(s.messages,u,new Set,d,i,r),m(e,t)}).catch(s=>{console.error("Ошибка загрузки сообщений:",s)})}if(window.innerWidth<=768){const e=document.createElement("div");e.className="burger-menu",e.innerHTML=`
            <div class="burger-icon">
                <span></span>
                <span></span>
                <span></span>
            </div>
        `;const t=document.querySelector(".chat-header");if(t){t.appendChild(e);const n=document.querySelector(".user-list"),a=document.querySelector(".chat-box");n&&a&&e.addEventListener("click",()=>{n.classList.toggle("active"),a.classList.toggle("inactive")})}}const l=document.getElementById("chat-list");l&&l.addEventListener("click",e=>{const t=e.target.closest("li");if(!t)return;const n=t.getAttribute("data-chat-id"),a=t.getAttribute("data-chat-type");if(!(r===n&&i===a)&&(h(n,a),window.innerWidth<=768)){const c=document.querySelector(".user-list"),o=document.querySelector(".chat-box");c&&o&&(c.classList.remove("active"),o.classList.remove("inactive"),c.classList.add("inactive"),o.classList.add("active"))}})});
